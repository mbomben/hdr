\chapter{ATLAS}
\label{chap:ATLAS}

In this Chapter the ATLAS Pixel detector will be discussed, with a special focus on radiation
 damage. 
After a short introduction to the Large Hadron Collider (LHC) Physics program in 
Section~\ref{sec:LHCPhysics}, the ATLAS detector, one of the experiments at the LHC, will be 
presented (Section~\ref{sec:ATLASDetector}). Particular emphasis will be devoted to the 
the ATLAS Pixel Detector (Section~\ref{sec:ATLASPixelDetector}), before moving to the 
core of this Chapter - Section~\ref{sec:digitizer} -
 where the modelization of the radiation damage to the ATLAS Pixel 
Detector will be discussed. 

\section{The LHC Physics Program}
\label{sec:LHCPhysics}
Understanding the nature of electroweak symmetry breaking, and in particular  specifically 
deciphering the Higgs mechanism, is the main goal of the ATLAS~\cite{AtlasDetector} and 
CMS~\cite{CMSDetector} experiments at the LHC~\cite{LHCMachine}. 

The LHC is an hadron accelerator and collider located about 100~m underground, in the former 
Large Electron Positron (LEP) collider tunnel, at the French-Swiss border in the vicinity of Geneva. As LEP, LHC too was built by CERN, the European 
Organization for Nuclear Research. The LHC has a circumference of 27~km and uses 
superconducting magnets to bend proton beams with energy up to a design value of 7~TeV; hence 
the maximum achievable center-of-mass energy $\sqrt{s}$ for $pp$ collisions is of 14~TeV. The design instantaneous 
luminosity of the LHC is of $L=1.0\times10^{34}$/cm$^{2}$/s, which is equivalent to 10/nb/s. 
The $pp$ total cross section $\sigma_{tot}$ at $\sqrt{s}$ of 14~TeV is about 10$^8$~nb, 
so the event rate at LHC is in the order of 10$^9$~Hz. 
The protons are packed in bunches of about 10$^{11}$ particles; the bunch crossing frequency $\nu$ is 
of 40~MHz.  The ratio of event rate to $\nu$ gives the average number of $pp$ collisions per 
bunch crossing, the so-called {\it pile-up}; it is customary indicated with $\mu$ and for the LHC 
design values is of about 25 interactions per bunch crossing.

At the LHC the physics cross-sections are dominated by QCD 
jet production, which
is many orders of magnitude larger than the production of the
most interesting physics
channels. The latter are usually characterised by electroweak cross-sections. Figure~\ref{fig:sec1_cross_lhc} shows the production cross-sections for several
representative processes at hadron colliders, as a function of the center-of-mass energy.
It can be seen that the  production cross section of a light Higgs is of the order of several tens of nb so 
the Higgs boson is produced about once every billion collisions of the LHC.

\begin{figure}[!htbp]
\centering
\includegraphics[width=0.43\textwidth]{sec1_cross_lhc.png}
\caption{\label{fig:sec1_cross_lhc}Production cross-sections for several represe
ntative processes at hadron colliders. (After~\cite{Weiglein:2004hn})}
\end{figure}

As already mentioned in Chapter~\ref{chap:context}
the two collaborations have both observed a boson compatible with the SM Higgs in 2012; 
since then the nature of that particle and its coupling to fundamental SM bosons and fermions 
keep being pursued.  Recently ATLAS reported evidence of $H\to\b\b$ decay~\cite{ATLASHbb2017} 
when produced in association with a $W$ or $Z$ boson; the CMS collaboration announced 
the first observation of Higgs boson decays to $\tau$ leptons~\cite{CMSHtautau2017}. 
The search for the Higgs boson decaying to second generation fermions is next on the 
agenda of the ATLAS and CMS collaborations (example:~\cite{ATLASHmumu2017}).

Other than the Higgs, a central goal of the physics program of the LHC is the exploration of particles and 
interactions at the TeV energy scale, which may hold answers to some of the most profound questions in 
particle physics, like what is dark matter made of and how the Higgs boson mass gets stabilised.

The total delivered luminosity so far from the LHC to the ATLAS experiment  is shown in 
Figure~\ref{fig:intlumivsyear}~\cite{ATLASLumi}.

\begin{figure}[!htpb]
\centering
\includegraphics[width=0.62\textwidth]{intlumivsyear.png}
\caption{\label{fig:intlumivsyear}Cumulative luminosity versus day delivered to ATLAS during stable 
beams and for high energy p-p collisions. (After~\cite{ATLASLumi})}
\end{figure}

To exploit at best this dataset, to perform precision measurements 
and to face the high interaction rates, radiation doses, particle multiplicities and energies of 
LHC $pp$ collisions the ATLAS detector was built. In the next Section the salient features of this 
detector will be presented.

\section{The ATLAS Detector}
\label{sec:ATLASDetector}
ATLAS~\cite{AtlasDetector} is a general-purpose particle detector covering nearly the entire solid 
angle\footnote{ATLAS uses a right-handed coordinate system with its origin at the nominal interaction 
point (IP) in the centre of the detector and the $z$-axis coinciding with the axis of the beam pipe.  The 
$x$-axis points from the IP towards the centre of the LHC ring, and the $y$-axis points upward. 
Cylindrical coordinates ($r$,$\phi$) are used in the transverse plane, $\phi$ being the azimuthal angle 
around the $z$-axis. The pseudorapidity is defined in terms of the polar angle $\theta$ as $\eta = - \ln 
\tan(\theta/2)$. The distance in ($\eta$,$\phi$) coordinates, $\Delta R = \sqrt{(\Delta\phi)^2+
(\Delta\eta)^2}$, is also used to define cone sizes. Transverse momentum and energy are defined as $
\pt=p\sin\theta$ and $\et=E\sin\theta$, respectively.} around the collision point. It consists of an inner 
tracking detector surrounded by a thin superconducting solenoid, electromagnetic and hadronic 
calorimeters,
and a muon spectrometer incorporating three large superconducting toroidal magnets. 
Figure~\ref{fig:ATLASDetector} shows a schematic view of the ATLAS detector.

\begin{figure}[!htpb]
\centering
\includegraphics[width=0.65\textwidth]{ATLASDetector.pdf}
\caption{\label{fig:ATLASDetector}Cut-away view of the ATLAS detector. The dimensions of the detector are 25 m in height and 44 m in length. The overall weight of the detector is approximately 7000 tonnes.
 (After~\cite{AtlasDetector})}
\end{figure}


The inner tracking detector (ID or {\it inner detector})~\cite{ATLASIDTDR}, located within a 2~T axial magnetic field generated by the superconducting solenoid, is used to measure the trajectories and momenta of charged particles. The inner layers, consisting of high-granularity silicon pixel detectors, instrument a pseudorapidity
range $|\eta| < 2.5$.
A new innermost silicon pixel layer, the insertable B-layer~\cite{IBLTDR} (IBL), was added to the detector between the first two LHC runs (Run~1 and Run~2 - see Figure~\ref{fig:HL-LHC-plan-2016-01}). The IBL improves the ability to identify displaced vertices and thereby significantly improves the $b$-tagging performance~\cite{ATL-PHYS-PUB-2015-022}. More details 
on the pixel detector will be given in the next Section.
Silicon strip detectors covering $|\eta| < 2.5$ are located beyond the pixel detectors. 
Outside the strip detectors and covering $|\eta | < 2.0$, there are straw-tube tracking detectors, which also provide measurements of transition radiation that are used in electron identification.
Figure~\ref{fig:ATLASID} shows the barrel section of the ID.

\begin{figure}[!htbp]
\centering
\includegraphics[width=0.65\textwidth]{ATLAS_ID.png}
\caption{\label{fig:ATLASID}Schematic view of the  barrel part of the ATLAS Inner Detector (ID), including the new Insertable B-Layer (IBL). (After~\cite{Potamianos:2016ptf})}
\end{figure}


The calorimeter system covers the pseudorapidity range $|\eta| < 4.9$.
Within the region $|\eta|< 3.2$, electromagnetic calorimetry is provided by barrel ($|\eta| < 1.475$) and
endcap ($1.375 < |\eta| < 3.2$) high-granularity lead/liquid-argon (LAr) electromagnetic calorimeters,
with an additional thin LAr presampler covering $|\eta| < 1.8$ to correct for energy loss in material upstream of the calorimeters.
Hadronic calorimetry is provided by a steel/scintillator-tile calorimeter, segmented into three barrel structures within $|\eta| < 1.7$, and two copper/LAr hadronic endcap calorimeters extend the coverage to $|\eta|=3.2$.
The solid angle coverage for $|\eta|$ between 3.2 and 4.9 is completed with copper/LAr and tungsten/LAr calorimeter modules optimised for electromagnetic and hadronic measurements, respectively.

The outermost part of the detector is the muon spectrometer, which measures the curved trajectories of muons in the field of three large air-core toroidal magnets. High-precision tracking is performed within the range $|\eta| < 2.7$ and there are chambers for fast triggering within the range $|\eta| < 2.4$.

The proton-proton interaction rate at the design luminosity of $L=1.0\times10^{34}$/cm$^{2}$/s 
is approximately 1 GHz, while the event data recording, based on technology and resource limitations, 
is limited to about 200 Hz. For this purpose ATLAS designed 
a three-level trigger system selects events to be recorded for offline analysis, to assure 
an overall rejection factor of $5\times10^{6}$ against minimum-bias processes while maintaining 
maximum efficiency for the new physics. 
The Level-1 (L1) trigger system uses a subset of the total detector information to make a decision on 
whether or not to continue processing an event, reducing the data rate to approximately 75~kHz (limited 
by the bandwidth of the readout system, which was upgraded to 100~kHz between Run~1 and Run~2). 
The subsequent two levels, 
collectively known as the high-level trigger, are the Level-2 (L2) trigger and the event filter. They provide 
the reduction to a final data-taking rate of approximately 200~Hz (upgraded to 100~kHz between 
Run~1 and Run~2)~\cite{AtlasTrigger2015}. A new Fast TracKer (FTK) system~\cite{FTKTDR} will 
provide global ID track reconstruction at the L1 trigger rate
using lookup tables stored in custom associative memory chips for the pattern recognition.  This 
system is currently being installed and expected to
be fully commissioned by the end of 2017.



\section{The ATLAS Pixel Detector}
\label{sec:ATLASPixelDetector}

This Section is devoted to the silicon pixel tracking system for the ATLAS experiment. 
The pixel detector was initially composed of three barrel layers plus s a total of six disk layers, three at 
each end of the barrel region~\cite{AtlasPixels}. During the Long Shutdown 1 (LS1), between 
the LHC Run~1 and Run~2 (see Figure~\ref{fig:HL-LHC-plan-2016-01}), a fourth barrel layer was inserted, at a smaller radius than the existing 
pixel detector; it is called the Insertable B-Layer (IBL)~\cite{IBLTDR}.
Figure~\ref{fig:ATLASPixels} shows a schematic view of the ATLAS pixel detector in Run~2; the total 
detector length is 1442~mm. 
\begin{figure}[!htbp]
\centering
\includegraphics[width=0.65\textwidth]{ATLASPixels.jpg}
\caption{\label{fig:ATLASPixels}Schematic view of the ATLAS 4-Layer Pixel Detector for Run 2. 
On top the different pixel layers are indicated; at the bottom the radii of the four barrel layers are shown, together with the distance from the interaction point of the beam pipe and support structures. (After~\cite{BACKHAUS201665})}
\end{figure}

This Section will cover first the physics motivations and the salient features of the original pixel detector, and later discuss the IBL. The material presented here is taken from~\cite{AtlasPixels}~and~\cite{IBLTDR}.

\subsection{Performance Requirements for the Pixel Detector and System Overview}
\label{sec:pixeloverview}
The pixel detector system is the innermost element of the ATLAS ID. The pixel detector contains 
approximately 80 million channels and provides pattern recognition capability in order to meet the track 
reconstruction requirements of ATLAS at the full luminosity of the LHC ($L=1.0\times10^{34}$/cm$^{2}$/s). It is the most important detector used in the identification and reconstruction of secondary vertices from the decay of, for example, particles containing a $b$-quark or for $b$-tagging of jets. In addition, it provides excellent spatial resolution for reconstructing primary vertices coming from the $pp$ interaction region within ATLAS even in the presence of the multiple interactions at the LHC design luminosity. 

In what follows the  performance requirements for the pixel detector will be presented, then 
an overview of the system.

\subsubsection{Pixel Detector Performance Requirements}
The performance requirements that guided the design of the pixel detector are:

\begin{itemize}
\item coverage of the pseudorapidity range $|\eta|<2.5$;
\item impact parameter resolution in the transverse plane better than 15~$\mu$m;
\item uncertainty in the longitudinal plane $\sigma(z)$ on the reconstruction of vertices of about 1~mm;
\item three-dimensional-vertexing capabilities;
\item very good b-jet tagging capabilities both in the high-level trigger and in the offline reconstruction; 
\item  minimal material for all elements in the system, in order to reduce multiple scattering and secondary interactions;
\item excellent efficiency for all pixel layers; and
\item radiation hardness of the pixel detectors elements to operate after a total dose of 500 kGy 
and fluence $\Phi=1\times10^{15}$~n$_{\rm eq}$/cm$^2$
\end{itemize}

These performance requirements lead to the following major design choices:

\begin{itemize}
\item three pixel hits over the full rapidity range;
\item minimal radius of the innermost layer (b-layer), set at 5 cm due to the practical limitations of clearances around the interaction region beam pipe vacuum system\footnote{this limit was then overcome with the installation of the IBL};
\item the smallest pixel size achievable, which is set to 50~$\mu$m~$\times$~400~$\mu$m by electronics design limitations.
\end{itemize}

\subsubsection{Pixel Detector Overview}
The pixel tracker is designed to provide at least three points on a charged track emanating from the 
collision region in ATLAS. 
The principal components of the pixel tracking system, before adding the IBL, were the following:
\begin{itemize}
\item the active region of the pixel detector, which is composed of three barrel layers and a total of six disk layers, three at each end of the barrel region;
\item internal services (power, monitoring, optical input/output and cooling) and their associated mechanical support structures (also supporting the interaction region beam pipe) on both ends of the active detector region;
\item a Pixel Support Tube into which the active part of the pixel detector and the services and related support structures are inserted and located; and
\item external services that are connected to the internal services at the end of the Pixel Support Tube.
\end{itemize}

The active part of the pixel system consists of three barrel layers-Layer 0 (so-called b-layer), Layer 1 
and Layer 2-and two identical endcap regions, each with three disk layers, as it cam be seen in 
Figure~\ref{fig:ATLASPixels}. The basic building block of the active part of the pixel detector is a module 
that is composed of silicon sensors, front-end electronics and flex-hybrids with control circuits.
Modules are mounted on mechanical/cooling supports, called staves, in the barrel region. 
In the endcap modules are mounted on mechanical/cooling supports, called disk sectors; There are 
eight identical sectors in each disk. The concept of  pixel module is illustrated in Figure~\ref{fig:Pixel_module}.
\begin{figure}[!htbp]
\centering
\includegraphics[width=0.65\textwidth]{Pixel_module.png}
\caption{\label{fig:Pixel_module}Assembly view and cross-section of an ATLAS Pixel Detector module. (After~\cite{AtlasPixels})}
\end{figure}


A description of the pixel sensors characteristics follows.

\subsubsection{Pixel sensors}
\label{sec:pixelsensors}

The total number of pixels in the system is approximately 67 million in the barrel and 13 million in the endcaps, covering a total active area of about 1.7~m$^2$.
The  sensors  choice for ATLAS was of $n-on-n$ pixels on high resistivity, nominally 250~$\mu$m 
thick bulk. For each sensor tile, the 47232 pixel implants are arranged in 144 columns and 328 rows. 
For most of the pixel cells the pitch is of 	400~$\mu$m~$\times$~50~$\mu$m; in 16 columns 
the pitch is of 600~$\mu$m~$\times$~50~$\mu$m. In each column eight pairs of pixel implants, located 
near the center lines, are ganged to a common read-out, resulting in 320 independent read-out rows or 
46080 pixel read-out channels. This arrangement was chosen to allow for the connection of the sensor 
tile to 16 electronic front- end chips (see next Section). 
Oxygen impurities had been introduced in the bulk to increase tolerance of the silicon against bulk damage caused by charged hadrons~\cite{Lindstrom:421210,LINDSTROM200160}.
The sensors can be fully depleted before type inversion with bias voltages below 100~V. After type 
inversion the depletion zone grows primarily from the segmented $n^+$ implant when the region of 
highest electric field in the bulk now converts to $p$-type.

On the sensor front side, pixel structures are arranged and isolated by moderated p-spray impants, 
which have proven to be radiation tolerant with respect to surface damages induced by ionising charged 
particles for doses up to 500~kGy in silicon. The layout of the moderated p-spray impants is 
shown in Figure~\ref{fig:modpspray}. This isolation technique avoids high field regions in the interface between the pixel isolation and the bulk and ensures radiation tolerance of the design.
\begin{figure}[!htbp]
\centering
\includegraphics[width=0.49\textwidth]{modpspray.png}
\includegraphics[width=0.39\textwidth]{biasgrid.png}
\caption{\label{fig:modpspray}(left) Layout of the moderated p-spray isolation. (right)  Layout detail of the bias grid (After~\cite{AtlasPixels})}
\end{figure}
All 46080 read-out channels of a sensor tile are connected to a common bias grid structure, presented 
in Figure~\ref{fig:modpspray}, by employing a punch-through connection technique to each channel.
 The method biases the entire sensor without requiring individual connections, but still ensures isolation between pixels. The bias grid has been used for quality assurance measurements before the read-out electronics are connected to the sensors. 

On the sensor tile backside a series of guard rings (GRs) were defined by $p^+$ implants. The GRs 
assures a controlled potential drop from  $p^+$ implant negative bias voltage to ground. 
A sketch of the pixel sensor edge, with the read out electronics on top is given in 
Figure~\ref{fig:sensorbb}.
\begin{figure}[!htbp]
\centering
\includegraphics[width=1.00\textwidth]{sensorbb.png}
\caption{\label{fig:sensorbb} Cross section sketch of the ATLAS pixel module (After~\cite{Altenheiner:2012zz})}
\end{figure}

\section{Radiation Damage to the ATLAS Pixel Detector}
\label{sec:digitizer}

